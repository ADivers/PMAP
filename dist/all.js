var APP=APP||{};APP=function(){function e(e){var t="<ViewFields>";for(var o in e)t+='<FieldRef Name="'+e[o],t+='"/>';return t+="</ViewFields>"}function t(){var e=$("#employees tbody tr");$("#search").keyup(function(){var t,o="^(?=.*\\b"+$.trim($(this).val()).split(/\s+/).join("\\b)(?=.*\\b")+").*$",a=RegExp(o,"i");e.show().filter(function(){return t=$(this).text().replace(/\s+/g," "),!a.test(t)}).hide()})}var o,a,r={"Employee Name":"employee_name","Employee ID":"employee_ID","Admin ID":"admin_ID","Director ID":"director_ID","Manager ID":"manager_ID","Team Lead ID":"teamlead_ID"},n="https://teams.deloitte.com/sites/FDAJDD/Sandbox/";return{getFieldnames:e,getEmployeeList:function(){var n=e(r);$().SPServices({operation:"GetListItems",viewName:"",webURL:"https://teams.deloitte.com/sites/FDAJDD/Sandbox/",listName:"Employee_List01",CAMLViewFields:n,CAMLRowLimit:1e3,CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>TRUE</IncludeMandatoryColumns></QueryOptions>",CAMLQuery:'<Query><OrderBy><FieldRef Name="employee_name" Ascending="TRUE"></FieldRef></OrderBy></Query>',completefunc:function(e,r){console.log("STATUS: "+r);var n=$(e.responseXML).SPFilterNode("z:row").SPXmlToJson({mapping:{ows_employee_name:{mappedName:"employee_name",objectType:"Text"},ows_employee_ID:{mappedName:"employee_ID",objectType:"Text"},ows_admin_ID:{mappedName:"admin_ID",objectType:"Text"},ows_director_ID:{mappedName:"director_ID",objectType:"Text"},ows_manager_ID:{mappedName:"manager_ID",objectType:"Text"},ows_teamlead_ID:{mappedName:"teamlead_ID",objectType:"Text"}},includeAllAttrs:!1,removeOws:!0,sparse:!1});a=APP.util.extendDeep(n),console.log(a),o=[],$(e.responseXML).SPFilterNode("z:row").each(function(){console.log($(this).attr("ows_ID")),o.push($(this).attr("ows_ID"))}),max=n.length,buildEditButtons(n),buildEmployeeTable(n),t()}})},getWebUrl:function(){return n},makeValuepairs:function(e,t){var o,a=[],r=t.length;for(o=0;o<r;o+=1){var n=[];if("[object Object]"===Object.prototype.toString.call(e[o]))for(var i in e[o])n.push(t[o]),n.push(e[o][i]),a.push(n);else n.push(t[o]),n.push(e[o]),a.push(n)}return console.log("From makeValuepairs: "),console.dir(a),a}}}();
APP.CritElem=function(e,t){function o(){return p}function s(t){e.spsQuery.getSPSListItems(t)}function i(t){m.employeePositionID=t.employeePositionID,m.CAMLQuery='<Query>\n<Where>\n<Eq>\n<FieldRef Name="positionID"/>\n<Value Type="Text">'+m.employeePositionID+"</Value>\n</Eq>\n</Where>\n</Query>\n",console.log("-----------------------------------\x3eFrom getRevieweeJobDetails: "),console.log(m),"1"===m.employeePositionID||"2"===m.employeePositionID||"3"===m.employeePositionID||"4"===m.employeePositionID?e.spsQuery.getSPSListItems(m):(m.listName="CritElemUniquePositions",e.spsQuery.getSPSListItems(m))}var n=e.getWebUrl(),p={operation:"GetListItems",viewName:"",webURL:n,listName:"CritElemsGeneric",CAMLRowLimit:1e3,CAMLViewFields:{ID:"ID",Title:"Title",perfElemID:"perfElemID",perfElemType:"perfElemType",perfElemDesc:"perfElemDesc",measurement:"measurement"},CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>TRUE</IncludeMandatoryColumns></QueryOptions>",mapping:{ows_Title:{mappedName:"title",objectType:"Text"},ows_perfElemID:{mappedName:"perfElemID",objectType:"Text"},ows_perfElemType:{mappedName:"perfElemType",objectType:"Text"},ows_perfElemDesc:{mappedName:"perfElemDesc",objectType:"Text"},ows_measurement:{mappedName:"measurement",objectType:"Text"},ows_ID:{mappedName:"ID",objectType:"Text"}},completefunc:function(e){var t,o;$("#elem-title");console.log("-----------------------------------\x3eFrom completefunc: genericCritElemsQueryConfigObj"),console.log(e);for(var s=0;s<e.length;s+=1)t=$("<option></option>").text(e[s].title).val(e[s].title).attr("data-perfElemDesc",e[s].perfElemDesc).attr("data-measurement",e[s].measurement).attr("data-elemID",e[s].ID),$("#elem-title").append(t),s+1===e.length&&(o=$("<option>Create New</option>").val("Create New"),$("#elem-title>option").eq(e.length-1).after(o)),$("select").material_select();var i=$("#elem-title>option:first-of-type").attr("data-perfElemDesc"),n=$("#elem-title>option:first-of-type").attr("data-measurement");console.log("First Description: "+i),$("#elem-desc").text(i),$("#elem-measure01").text(n)}},r={operation:"GetListItems",viewName:"",webURL:n,listName:"PerfElemDescriptions",CAMLRowLimit:1e3,CAMLViewFields:{perfElemDescID:"perfElemDescID",Title:"Title",elemType:"elemType",description:"description",ID:"ID"},CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>TRUE</IncludeMandatoryColumns></QueryOptions>",CAMLQuery:!1,mapping:{ows_perfElemDescID:{mappedName:"perfElemDescID",objectType:"Text"},ows_Title:{mappedName:"Title",objectType:"Text"},ows_elemType:{mappedName:"elemType",objectType:"Text"},ows_description:{mappedName:"description",objectType:"Text"},ows_ID:{mappedName:"ID",objectType:"Text"}},completefunc:function(e){$("#elem-title");for(var t,o=0;o<e.length;o+=1)t=$("<option></option>").text(e[o].Title).val(e[o].Title).attr("data-perfElemDesc",e[o].description).attr("data-elemID",e[o].ID),$("#elem-title").append(t),$("select").material_select()}},l={operation:"GetListItems",viewName:"",webURL:n,listName:"Employees",CAMLRowLimit:1,CAMLViewFields:{positionID:"positionID"},CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>TRUE</IncludeMandatoryColumns></QueryOptions>",CAMLQuery:!1,mapping:{ows_positionID:{mappedName:"positionID",objectType:"Text"}},completefunc:function(e){console.log("BEGINNING COMPLETE FUNCTION FROM REVIEWEE JOB POSITION----\x3eres:"),console.log(e),$("#reviewee-name").attr("data-position-id",e[0].positionID);var t={employeePositionID:e[0].positionID},s=o(),n=t.employeePositionID;if(i(t),"1"===n||"2"===n||"3"===n||"4"===n){var p='<Query>\n<Where>\n<Eq>\n<FieldRef Name="positionID"/>\n<Value Type="Text">'+n+"</Value>\n</Eq>\n</Where>\n</Query>",r=APP.CritElem.getCritElemsPerfQueryConfigObj();r.CAMLQuery=p,APP.spsQuery.getSPSListItems(r),$("#reviewee-name").attr("data-position-id",n)}else APP.spsQuery.getSPSListItems(s)}},m={operation:"GetListItems",viewName:"",webURL:n,listName:"CritElemUniquePositions02",CAMLRowLimit:1e3,CAMLViewFields:{positionID:"positionID",positionDesc:"positionDesc",occSeries:"occSeries",gsLevel:"gsLevel"},CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>TRUE</IncludeMandatoryColumns></QueryOptions>",CAMLQuery:!1,mapping:{ows_positionID:{mappedName:"positionID",objectType:"Text"},ows_positionDesc:{mappedName:"positionDesc",objectType:"Text"},ows_occSeries:{mappedName:"occSeries",objectType:"Text"},ows_gsLevel:{mappedName:"gsLevel",objectType:"Text"}},completefunc:function(e){$('[name="pos-desc"]').attr("value",e[0].positionDesc),$('[name="occ-series"]').attr("value",e[0].occSeries),$('[name="gs-level"]').attr("value",e[0].gsLevel)}},a="<QueryOptions><IncludeMandatoryColumns>TRUE</IncludeMandatoryColumns></QueryOptions>",u={operation:"GetListItems",viewName:"",webURL:n,listName:"CritElemsAdmin",CAMLRowLimit:1e3,CAMLViewFields:{adminElemID:"adminElemID",mgrSuprFlag:"mgrSuprFlag",reqs:"reqs"},CAMLQueryOptions:a,CAMLQuery:!1,mapping:{ows_adminElemID:{mappedName:"adminElemID",objectType:"Text"},ows_mgrSuprFlag:{mappedName:"mgrSuprFlag",objectType:"Text"},ows_reqs:{mappedName:"reqs",objectType:"Text"}},completefunc:function(){}},c={operation:"GetListItems",viewName:"",webURL:n,listName:"PositionToElems",CAMLRowLimit:1e3,CAMLViewFields:!1,CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>TRUE</IncludeMandatoryColumns></QueryOptions>",CAMLQuery:!1,mapping:{ows_positionID:{mappedName:"positionID",objectType:"Text"},ows_perfElemDescID:{mappedName:"positionDescID",objectType:"Text"}},completefunc:function(e){for(var t,o=[],i=0;i<e.length;i++)t=e[i].positionDescID,o.push(t);o.push("Create New");for(var n=0;n<o.length;n+=1)if("Create New"!==o[n]){var p=APP.util.extendDeep(r);p.CAMLQuery='<Query>\n<Where>\n<Eq>\n<FieldRef Name="perfElemDescID"/>\n<Value Type="Text">'+o[n]+"</Value>\n</Eq>\n</Where>\n</Query>\n",s(p)}else{var l=$("<option></option>").val(o[n]).text(o[n]);$("#elem-title").append(l)}}},y={operation:"GetListItems",viewName:"",webURL:n,listName:"CritElemUniquePositions",CAMLRowLimit:1e3,CAMLViewFields:{positionID:"positionID",positionDesc:"positionDesc",occupationSeries:"occupationSeries",gsLevel:"gsLevel"},CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>TRUE</IncludeMandatoryColumns></QueryOptions>",mapping:{ows_positionID:{mappedName:"positionID",objectType:"Text"},ows_positionDesc:{mappedName:"positionDesc",objectType:"Text"},ows_occupationSeries:{mappedName:"occupationSeries",objectType:"Text"},ows_gsLevel:{mappedName:"gsLevel",objectType:"Text"}},completefunc:function(){}},C=Math.floor(9e5*Math.random())+1e5,d={operation:"UpdateListItems",webURL:n,listName:"CustomElemsBank",batchCmd:"New",updates:'<Batch OnError="Continue">\n<Method ID="'+C+'" Cmd="New">\n',completefunc:function(){console.log("From saveCustomElemsQueryObj: Record created successfully.");var t,o=window.location.search.split("&")[4].split("=")[1];console.log(o),this.vals&&(console.log("Vals: "),console.log(this.vals),t={operation:"GetListItems",viewName:"",webURL:n,listName:"CustomElemsBank",CAMLRowLimit:1e3,CAMLViewFields:{ID:"ID"},CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>TRUE</IncludeMandatoryColumns></QueryOptions>",CAMLQuery:'<Query>\n<Where>\n<And>\n<Eq>\n<FieldRef Name="elemCreatorID"/>\n<Value Type="Text">MGR-12345</Value>\n</Eq>\n<Eq>\n<FieldRef Name="elemTitle"/>\n<Value Type="Text">'+this.vals[1].value+"</Value>\n</Eq>\n</And>\n</Where>\n</Query>",mapping:{ows_ID:{mappedName:"ID",objectType:"Text"}},completefunc:function(s){customElemCopy=e.util.extendDeep(s),console.log("#########-----\x3eFrom customElemQueryObj complete function: "),console.log(t.CAMLQuery),console.log(s),console.log("###################--------------\x3ecustomElemCopy:"),console.log(customElemCopy);var i={operation:"GetListItems",viewName:"",webURL:n,listName:"PMAPDocs",CAMLRowLimit:1,CAMLViewFields:{ID:"ID",perfCritElemsList:"perfCritElemsList"},CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>TRUE</IncludeMandatoryColumns></QueryOptions>",CAMLQuery:'<Query>\n<Where>\n<Eq>\n<FieldRef Name="pmapDocID"/>\n<Value Type="Text">'+o+"</Value>\n</Eq>\n</Where>\n</Query>",mapping:{ows_ID:{mappedName:"ID",objectType:"Text"},ows_perfCritElemsList:{mappedName:"perfCritElemsList",objectType:"Text"}},completefunc:function(t){console.log("#########-----\x3eFrom pmapDocQueryObj complete function: "),console.log(t);var o=Math.floor(9e5*Math.random())+1e5,s=t[0].ID;if(resCopy=e.util.extendDeep(t[0]),console.log("------------------------------\x3e***resCopy"),console.log(resCopy),""!==resCopy.perfCritElemsList){console.log("----------------------------\x3eresCopy.perfCritElemsList:1"),console.log(resCopy.perfCritElemsList),resCopy.perfCritElemsList=resCopy.perfCritElemsList.split(","),console.log("----------------------------\x3eresCopy.perfCritElemsList:2");var i=resCopy.perfCritElemsList.length;""===resCopy.perfCritElemsList[i-1]&&resCopy.perfCritElemsList.pop(),console.log(resCopy.perfCritElemsList),resCopy.perfCritElemsList.push(customElemCopy[0].ID),resCopy.perfCritElemsList=resCopy.perfCritElemsList.toString(),console.log("----------------------------\x3eresCopy.perfCritElemsList:3"),console.log(resCopy.perfCritElemsList)}else console.log("-----------------------------\x3eCUSTOM ELEMENTS EMPTY;"),resCopy.perfCritElemsList=customElemCopy[0].ID+",";var p={operation:"UpdateListItems",webURL:n,listName:"PMAPDocs",batchCmd:"Update",updates:'<Batch OnError="Continue">\n<Method ID="1" Cmd="Update">\n<Field Name="ID">'+s+'</Field>\n<Field Name="perfCritElemsList">'+resCopy.perfCritElemsList+"</Field>\n</Method>\n</Batch>",ID:o,completefunc:function(e,t){console.log("#########-----\x3eFrom pmapDocUpdateQueryObj complete function: ")}};console.log("########--------------\x3epmapDocUpdateQueryObj: "),console.log(p),e.spsQuery.updateSPSRecord(p),resCopy=!1}};console.log(i),e.spsQuery.getSPSListItems(i)}},this.vals=!1),console.log(t),e.spsQuery.getSPSListItems(t)}};return{getRevieweePosition:function(t){e.spsQuery.getSPSListItems(t)},getCritElemsAdmin:function(t){var o='<Query>\n<Where>\n<Eq>\n<FieldRef Name="mgrSuprFlag"/>\n<Value Type="Text">'+t.mgrSuprFlag+"</Value>\n</Eq>\n</Where>\n</Query>";u.CAMLQuery=o,e.spsQuery.getSPSListItems(u)},getCritElemsPerformance:function(e){},getUniquePosQueryConfigObj:function(){return y},getUniquePositions:function(t){e.spsQuery.getSPSListItems(t)},getRevieweeJobDetailsConfObj:function(){return m},getRevieweeJobDetails:i,getRevieweePositionQueryConfigObj:function(){return l},getGenericCritElemsQueryConfigObj:o,getCritElemsPerfQueryConfigObj:function(){return c},getSaveCustomElemsQueryObj:function(){return d},saveNewCustomElem:function(e){APP.spsQuery.updateSPSRecord(e)}}}(APP);
APP.dateFormatter=function(e,t){return{makeDateString:function(e){return e=e.split(" "),e[1]=e[1].slice(0,e[1].length-1),e=e[1]+" "+e[0]+", "+e[2],console.log("########################################################################"),console.log(e),e},convertToISO:function(e){var t=new Date(Date.parse(e));return $().SPServices.SPConvertDateToISO({dateToConvert:t,dateOffset:"-05:00"})}}}(APP);
APP.dom=function(e,t,n){return{buildOverlay:function(e,t){var n=document.createElement("div");e.style.position="relative",n.setAttribute("id","overlay"),n.style.position="absolute",n.style.backgroundColor="rgba(51, 51, 51, 0.6)",n.style.width=window.innerWidth+"px",n.style.height=window.innerHeight+"px",n.style.top=window.pageYOffset+"px",n.style.left=window.pageXOffset+"px",n.style.zIndex="200",window.addEventListener("resize",function(){n&&(n.style.width=window.innerWidth+"px",n.style.height=window.innerHeight+"px",n.style.top=window.pageYOffset+"px",n.style.left=window.pageXOffset+"px ")},!1),window.addEventListener("scroll",function(){n&&(n.style.width=window.innerWidth+"px",n.style.height=window.innerHeight+"px",n.style.top=window.pageYOffset+"px",n.style.left=window.pageXOffset+"px ")},!1),e.appendChild(n),t&&n.appendChild(t)},buildEmployeeTable:function(e,t,n,a){var i,r;for(r=0;r<e.length;r+=1){tablerow=document.createElement("tr");for(i in e[r])e[r].hasOwnProperty(i)&&(tabledef=document.createElement("td"),tabledef.innerText=e[r][i],tablerow.appendChild(tabledef),n.appendChild(tablerow));var o=$("tr>td:last-of-type").get(r);if(parseInt(a[r].dataset.index)===r){var l=document.createElement("td");l.appendChild(a[r]),o.insertAdjacentElement("afterend",l)}}t.className="bordered highlight"},buildEditButtons:function(e,t){for(var n=0;n<e.length;n+=1){var a=document.createElement("button"),i=document.createElement("a"),r=document.createElement("i"),o="./pmapIntroduction.html?"+jQuery.param({id:e[n]["SP-ID"],firstName:e[n].firstName,lastName:e[n].lastName,mgrSuprFlag:e[n].mgrSuprFlag});r.className="material-icons",r.innerText="add",i.setAttribute("href",o),$(".tooltipped").tooltip({delay:50}),a.appendChild(r),i.appendChild(a),a.className="btn-floating tooltipped blue darken-4  modal-trigger",a.style.marginRight=".5px",a.style.marginTop="5px",a.setAttribute("data-position","right"),a.setAttribute("data-delay","50"),a.setAttribute("data-tooltip","Start/Edit a PMAP"),a.setAttribute("data-index",n),a.setAttribute("data-record-id",e[n]["SP-ID"]),i.setAttribute("data-index",n),$(a).tooltip({delay:50}),t.push(i)}return a},attachRevieweeURL:function(e,t,n){var a=n+"?";a+="id="+t.id,a+="&",a+="firstName="+t.firstName,a+="&",a+="lastName="+t.lastName,console.log(a),e.setAttribute("href",a)},displayRevieweeName:function(e,t){e.innerText=t.firstName+" "+t.lastName},showDeadlines:function(e){$('input[name="event-type"]').on({click:function(e){$("#current-event-id").attr("data-current","").text(""),$("#current-event-id").prev("h5").text("Current event record: "),$("#current-deadline").attr("placeholder",""),$("#reminder-text").text(""),e.data.listname=e.target.value,$(".hide.relative").removeClass("hide").attr("display","block"),t.spsQuery.getTablerecords(e.data)}},e)},createButtons:function(e,n,a,i,r){for(var o=0;o<e.length;o+=1){var l=document.createElement("button"),d=document.createElement("a"),c=document.createElement("i"),s="?";for(var p in r)r[p]=e[o][p],s+=jQuery.param(r);console.log(s),c.className="material-icons",c.innerText=i.iconText,d.setAttribute("href","#reminder-recipients"),$(".tooltipped").tooltip({delay:50}),l.appendChild(c),d.appendChild(l),l.className="btn-floating tooltipped blue darken-4  modal-trigger",l.style.marginRight=".5px",l.style.marginTop="5px",l.setAttribute("data-position","right"),l.setAttribute("data-delay","50"),l.setAttribute("data-tooltip",i.tooltip),l.setAttribute("data-index",o),l.setAttribute("data-record-id",e[o].ID),d.setAttribute("data-index",o),$(l).tooltip({delay:50}),"Edit this Reminder"===l.dataset.tooltip?$(l).on("click",null,{title:"Edit Details of PMAP Event: "},function(e){console.log("EVENT TARGET: "),console.dir(e.target);var n=$(this).data("record-id");$("#current-event-id").text(n).attr("data-current",n),$("#current-event-id").prev("h5").text("Current event record: "+n);var a=e.target,i=($(a).closest("td").prev("td"),$('input[name="event-type"]:checked').val()),r=APP.spsQuery.getSingleEventQConfigObject();return r.pmapCoordinatorID="PMAP-COORD-12345",r.ID=$(this).data("record-id"),r.CAMLQuery='<Query>\n<Where>\n<And>\n<Eq>\n<FieldRef Name="pmapCoordinatorID"/><Value Type="Text">'+r.pmapCoordinatorID+'</Value>\n</Eq>\n<Eq>\n<FieldRef Name="ID"/><Value Type="Text">'+r.ID+"</Value>\n</Eq>\n</And>\n</Where>\n</Query>",r.listName=i,r.completefunc=function(e){var t=e[0].msgText,n=e[0].dueDateIntervalEnd;$(".hide").not("#new-deadline").removeClass("hide").attr("display","block"),$("#current-deadline").attr("placeholder",n),$("#reminder-text").text(t)},t.spsQuery.getSPSListItems(r),!1}):"Delete this Reminder"===l.dataset.tooltip&&$(l).on("click",function(e){console.log("It's a delete button!!!");var n=$(this).data("record-id"),a=$('input[name="event-type"]:checked').val();console.log(e.target),console.log($(this).data("record-id"));var i={operation:"UpdateListItems",webURL:t.getWebUrl(),batchCmd:"Delete",ID:n,listName:a,updates:'<Batch OnError="Continue"><Method ID="1" Cmd="Delete"><Field Name="ID">'+parseInt(n,10)+"</Field></Method></Batch>",completefunc:function(){$("#success-msg .modal-content>p").text("Event Reminder record was deleted successfully."),$("#success-msg").modal("open")}};return console.log("Delete operation config object: "),console.log(i),t.spsQuery.updateSPSRecord(i),!1}),n.push(d)}return n},setHideListener:function(){$target=$(".hide"),$target.hasClass("hide")&&$target.removeClass("hide").attr("display","block")},submitPMAPEvent:function(e,n,a){var i=t.spsQuery.getSingleEventUpdateQObj(),r=t.spsQuery.makeCAMLString(e,n,a.batchCmd,a.ID);valPairs=t.makeValuepairs(e,n),i.valuepairs=valPairs,i.updates=r,i.listName=a.listName,i.createDate=a.createDate,i.batchCmd=a.batchCmd,"New"!==a.ID?i.ID=parseInt(a.ID):i.ID=a.ID,i.completefunc=function(){console.log("Hello from an update function! Here's a modal: "),$("#success-msg").modal("open")},console.log("********************Submit PMAP Event: queryConfigObj:"),console.dir(i),t.spsQuery.updateSPSRecord(i)},uncheckStaffLists:function(){$('#reminder-recipients input[type="checkbox"]').not("#all-employees").each(function(){})},uncheckAll:function(){return $("#all-employees").prop("checked",!1),!1},disableEditCtrls:function(){$("td button").addClass("disabled"),$("#deadlines>legend").text("SET DEADLINE FOR NEW PMAP EVENT:"),$("div").has('input[id="current-deadline"]').next("button").addClass("disabled"),$('label[for="deadline-picker"]').text("New Event Deadline: ")},badgeExpiringDeadlines:function(){var e,t,n,a,i,r,o,l,d;$("#my-pmap-events tbody tr td:nth-child(4n)").each(function(c,s){(o=s.innerText.split("-"))[2]=o[2].substr(0,o[2].length-9),o=new Date(o[0],o[1],o[2]),e=o.getUTCFullYear(),t=o.getUTCMonth(),n=o.getUTCDate(),o=Date.UTC(e,t,n),l=new Date(Date.now()),o/=864e5,a=l.getUTCFullYear(),i=l.getUTCMonth()+1,r=l.getUTCDate(),l=Date.UTC(a,i,r),(d=o-(l/=864e5))<=15&&d>0?$(s).css({"background-color":"#ff6f00",color:"#ffffff","font-weight":"bold"}):d<=0&&$(s).css({"background-color":"#b71c1c",color:"#ffffff","font-weight":"bold"})})},checkboxSelectionLogic:function(){$("#all-employees").on("change",function(e){$('#reminder-recipients input[type="checkbox"]').not("#all-employees").each(function(){!0===$(this).prop("checked")&&$(this).prop("checked",!1)}),!1===$('#reminder-recipients input[type="checkbox"]').not("#all-employees").eq(0).prop("checked")&&!1===$('#reminder-recipients input[type="checkbox"]').not("#all-employees").eq(1).prop("checked")&&!1===$('#reminder-recipients input[type="checkbox"]').not("#all-employees").eq(2).prop("checked")&&!1===$("#all-employees").prop("checked")&&$("#all-employees").prop("checked",!0)}),$('#reminder-recipients input[type="checkbox"]').not("#all-employees").on("change",function(e){return!0===$("#all-employees").prop("checked")&&$("#all-employees").prop("checked",!1),"undefined"===$(this).prop("checked")?$(this).prop("checked",!0):"checked"===$(this).prop("checked")&&$(this).prop("checked",!1),!1===$('#reminder-recipients input[type="checkbox"]').not("#all-employees").eq(0).prop("checked")&&!1===$('#reminder-recipients input[type="checkbox"]').not("#all-employees").eq(1).prop("checked")&&!1===$('#reminder-recipients input[type="checkbox"]').not("#all-employees").eq(2).prop("checked")&&!1===$("#all-employees").prop("checked")&&$("#all-employees").prop("checked",!0),!1})}}}(window,APP);
APP.dom.ui=function(){function e(){$('#clear, .input-field:has([id="new-elem-title"])').show(500,"easeInQuad")}function t(){$('#clear, .input-field:has([id="new-elem-title"])').hide(500,"easeOutQuad")}var a={msg:"<h5>Success!</h5><p>Your record was created successfully.</p>"};return{getConfigObj:function(){return a},redirectTo:function(e){window.location.assign(e)},buildEventQuery:function(e){var t=[],a=$("#create-reminder-form").serializeArray();t[0]="",createDate=new Date(Date.now()),createDate=$().SPServices.SPConvertDateToISO({dateToConvert:createDate,dateOffset:"-05:00"}),conf={},$setReminder=$("#set-reminder");for(var o=1;o<a.length;o+=1)for(var r in a[o])"name"===r&&("to"===a[o].name?(console.log("i: "+o+"formInputs[i].value: "+a[o].value),t[0]+=a[o].value+";"):t.push(a[o].value));t.push(createDate),listFieldValsArr=APP.spsQuery.getUpdateListFieldValsArr();var n=APP.dateFormatter.makeDateString(t[1]);remindDate=APP.dateFormatter.makeDateString(t[2]),t[1]=APP.dateFormatter.convertToISO(n),t[2]=APP.dateFormatter.convertToISO(remindDate),conf.listName=e.listName,conf.createDate=createDate,conf.ID=$("#current-event-id").data("current"),"New"===$setReminder.attr("data-batchCmd")?(conf.batchCmd=$setReminder.attr("data-batchCmd"),conf.ID=$setReminder.attr("data-batchCmd")):conf.batchCmd="Update",APP.dom.submitPMAPEvent(t,listFieldValsArr,conf)},showDeadlinesMeasurements:function(){$("#elem-title").on("change",function(a){var o=$("option",this),r=$(this).val();console.log("##################-------\x3e$options: "),console.log(r),"Create New"!==r&&t();for(var n=0;n<o.length;n+=1)console.log(o[n]),console.log("xxxxxxxxxxxxxxxxxxxxxxxxxxxxx"),console.log(o[n].getAttribute("data-perfElemDesc")),r===o[n].getAttribute("value")&&($("#elem-desc").text(o[n].getAttribute("data-perfElemDesc")),$("#elem-measure01").text(o[n].getAttribute("data-measurement")));"Create New"===r&&e()})},buildNewCritElemDiv:function(e){for(var t=$("<div></div>").addClass("my-elem, card, col, s12, m8").html("<h4>My Saved Element</h4>").css({position:"relative","padding-left":"15px",float:"left",width:"100%"}),a=$("<p></p>").text("Title: "+e.elemTitle),o=$("<p></p>").text("Desc: "+e.description),r=$("<p></p>").text("Measurements: "+e.measurements),n=$("<button></button>").addClass("btn-floating btn-large waves-effect waves-light").css({color:"#002071",float:"right"}).attr("position","absolute").append('<i class="material-icons">edit</i>'),i=[a,o,r],l=0;l<i.length;l+=1)$(i[l]).css({width:"90%",float:"left",border:"2px solid blue"}),t.append(i[l]);console.log("----------\x3eNew Crit Elem<---------------"),console.log(t),$("#target").append(t),console.log("#---------------#"),console.log(t.height()),t.append(n),n.css({top:-t.height()/2+n.height()/2,left:-n.width()/2}),console.log(n.height())}}}();


APP.meetings=function(e,t){function n(e,t){for(var n='<Batch OnError="Continue"><Method ID="1" Cmd="New">',a=0;a<t.length;a++)n+='<Field Name="'+l[a],n+='">',n+=e[Object.getOwnPropertyNames(e)[a]],n+="</Field>";return n+="</Method></Batch>"}function a(){var a,o,i,d,u,m,p,v=$("#create-meeting"),S=new Date(Date.now()),T=$('input[name="start-date"]',v).val(),y=$('input[name="start-time"]',v).val(),C=$('input[name="end-date"]',v).val(),D=$('input[name="end-time"]',v).val(),f=$('input[name="meeting-location"]',v).val(),h=$('input[name="meeting-title"]',v).val(),A=[],N=Math.floor(89999*Math.random()+1).toString();C=C+" "+D,a=r(T=T+" "+y,y),a=new Date(a),o=r(C,D),o=new Date(o);var g=$().SPServices.SPGetStaticFromDisplay({webURL:c,listName:s,columnDisplayNames:["Title","End Time","Start Time","Location","Description","Created By","Created","Custom ID Number"]});console.log("STATIC COLUMN NAMES: "),console.dir(g),i={Title:h,Created:$().SPServices.SPConvertDateToISO({dateToConvert:S}),Author:"Marcus M. Garvey",Location:f,EventDate:$().SPServices.SPConvertDateToISO({dateToConvert:a}),EndDate:$().SPServices.SPConvertDateToISO({dateToConvert:o}),CustomerID:N};for(var L in i)i.hasOwnProperty(L)&&A.push(i[L]);d=n(i,l),$().SPServices({operation:"UpdateListItems",webURL:c,listName:"TEST_CAL01",updates:d,completefunc:function(n,a){if(console.log(n.responseText),$().SPServices({operation:"GetListItems",webURL:c,viewName:"",listName:"TEST_CAL01",CAMLViewFields:'<ViewFields><FieldRef Name="Title"/><FieldRef Name="ID"/></ViewFields>',CAMLQuery:'<Query><Where><And><Eq><FieldRef Name="Title"/><Value Type="Text">'+i.Title+'</Value></Eq><Eq><FieldRef Name="CustomerID"/><Value Type="Text">'+i.CustomerID+"</Value></Eq></And></Where></Query>",CAMLRowLimit:20,CAMLQueryOptions:"<QueryOptions><ExpandUserField>True</ExpandUserField></QueryOptions>",completefunc:function(e,t){console.log("@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@");var n=$(e.responseXML).SPFilterNode("z:row").SPXmlToJson({includeAllAttrs:!0});console.log(n)}}),console.log(a),"success"===a){var r=document.querySelector("body");t.dom.buildOverlay(r),u=document.createElement("div"),m=document.createElement("div"),p=document.createElement("div"),u.className="card",m.className="card-content",p.className="card-action",m.innerHTML='<span class="card-title">Your Meeting Has Been Created</span><p>An email has been sent to your meeting\'s attendees.</p>',p.innerHTML='<a id="refresh" href="#">OK</a>',u.appendChild(m),u.appendChild(p),u.style.position="absolute",u.style.top="50%",u.style.left="30%",overlay.appendChild(u),document.querySelector("#refresh").addEventListener("click",function(t){t.preventDefault(),e.location.reload()},!1)}}})}function r(e,t){var n,a,r,l,s,c=Object.getOwnPropertyNames(o),d=Object.getOwnPropertyNames(i);n=(n=(n=e.replace(/,\s/," ")).split(" "))[2]+"."+n[1]+"."+n[0]+".",n=(n+=t).split(".");for(var u=0;u<13;u++)n[1]===c[u]&&(n[1]=o[c[u]]),n[1]===d[u]&&(n[1]=i[d[u]]);return 1===n[2].length&&(n[2]="0"+n[2]),a=n[0],r=n[1],l=n[2],s=n[3],n=a+"-"+r+"-"+l+"T"+s}var o={Jan:"01",Feb:"02",Mar:"03",Apr:"04",May:"05",Jun:"06",Jul:"07",Aug:"08",Sep:"09",Oct:"10",Nov:"11",Dec:"12"},i={January:"01",February:"02",March:"03",April:"04",May:"05",June:"06",July:"07",August:"08",September:"09",October:"10",November:"11",December:"12"},l=["Title","Created","Author","Location","EventDate","EndDate","CustomerID"],s="TEST_CAL01",c="https://teams.deloitte.com/sites/FDAJDD/Sandbox";return{initMeeting:function(){console.log("Meeting initiated."),document.querySelector("#submit").addEventListener("click",a,!1)}}}(this,APP);
APP.PMAPDoc=function(e,t){var o=e.getWebUrl();return{createPMAPDoc:function(t){var a=["pmapDocID","employeeID","status","appraisalPeriodStartDate","appraisalPeriodEndDate","submissionYear","createDate"],r=Date.now(),s=new Date(r);formValsArr=[],t.pmapDocID="PMAP-DOC-"+t.firstName+"-"+t.lastName+"-"+t.id+"-DTS-"+r;var n,p=[t.pmapDocID,t.id,"In Progress"];$formInputs=$("#employee-select-form input"),$pInput=$("#projects-collections p:odd").not(function(){return"Appraisal Period End:"===this.innerText});for(var i=0;i<$formInputs.length;i++)p.push($formInputs[i].value);p.push(s.getFullYear().toString()),r=$().SPServices.SPConvertDateToISO({dateToConvert:s,dateOffset:"-05:00"}),p.push(r),n=e.makeValuepairs(p,a),console.log(n),$().SPServices({operation:"UpdateListItems",webURL:o,listName:"PMAPDocs",batchCmd:"New",valuepairs:n,ID:t.pmapDocID,completefunc:function(e,o){$().SPServices.SPDebugXMLHttpResult({node:e.responseXML}),console.log("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"),console.log(t)}})}}}(APP);
APP.spsQuery=function(e,t){function a(e){var t="<ViewFields>";for(var a in e)t+='<FieldRef Name="'+e[a],t+='"/>';return t+="</ViewFields>"}var n,o={firstName:"firstName",LastName:"lastName",employeeID:"employeeID",mgrSuprFlag:"mgrSuprFlag",positionTitle:"positionTitle"},i={firstName:"firstName",LastName:"lastName",employeeID:"employeeID",organization:"organization",positionTitle:"positionTitle",positionSeries:"positionSeries",positionGrade:"positionGrade",mgrID:"mgrID",directorID:"directorID"},r={ID:"ID",event_type:"event_type",createDate:"createDate",dueDateIntervalEnd:"dueDateIntervalEnd"},m="<QueryOptions><IncludeMandatoryColumns>TRUE</IncludeMandatoryColumns></QueryOptions>",s=e.getWebUrl(),p="Employees",l='<Query><Where><Or><Eq><FieldRef Name="mgrID"/><Value Type="Text">MGR-12345</Value></Eq><Eq><FieldRef Name="mgrID"/><Value Type="Text">MGR-56789</Value></Eq></Or></Where></Query>',d='<Query>\n<Where>\n<Eq>\n<FieldRef Name="pmapCoordinatorID"/><Value Type="Text">PMAP-COORD-12345</Value></Eq>\n</Where>\n<OrderBy>\n<FieldRef Name="dueDateIntervalEnd" Ascending="TRUE"/></OrderBy>\n</Query>',u={ows_ID:{mappedName:"ID",objectType:"Text"},ows_event_type:{mappedName:"event_type",objectType:"Text"},ows_createDate:{mappedName:"createDate",objectType:"Text"},ows_dueDateIntervalEnd:{mappedName:"intervalEndDueDate",objectType:"Text"}},c={ID:null,webURL:s,listName:null,rowLimit:1,CAMLViewFields:r={ID:"ID",event_type:"event_type",createDate:"createDate",dueDateIntervalEnd:"dueDateIntervalEnd",msgText:"msgText",msgSendDeadline:"msgSendDeadline"},CAMLQueryOptions:m,CAMLQuery:null,mapping:{ows_ID:{mappedName:"ID",objectType:"Text"},ows_event_type:{mappedName:"event_type",objectType:"Text"},ows_createDate:{mappedName:"createDate",objectType:"Text"},ows_dueDateIntervalEnd:{mappedName:"dueDateIntervalEnd",objectType:"Text"},ows_msgText:{mappedName:"msgText",objectType:"Text"},ows_msgSendDeadline:{mappedName:"msgSendDeadline",objectType:"Text"}}},y={operation:"UpdateListItems",webURL:e.getWebUrl(),listName:!1,batchCmd:!1,valuepairs:!1,ID:!1,completefunc:!1},T=["to","dueDateIntervalEnd","msgSendDeadline","msgText","createDate","pmapCoordinatorID"];return{buildCAMLViewfields:a,getReviewees:function(){a(o);var t=document.getElementById("employees"),i=document.querySelector("#employees>tbody"),r=[];$().SPServices({operation:"GetListItems",viewName:"",webURL:s,listName:p,CAMLRowLimit:1e3,CAMLViewFields:a(o),CAMLQueryOptions:m,CAMLQuery:l,completefunc:function(a,o){var m=$(a.responseXML).SPFilterNode("z:row").SPXmlToJson({mapping:{ows_firstName:{mappedName:"firstName",objectType:"Text"},ows_lastName:{mappedName:"lastName",objectType:"Text"},ows_ID:{mappedName:"SP-ID",objectType:"Text"},ows_mgrSuprFlag:{mappedName:"mgrSuprFlag",objectType:"Text"}},incluedAllAttrs:!0,removeOws:!0,sparse:!1});console.log("RES: "),n=APP.util.extendDeep(m),e.dom.buildEditButtons(m,r),e.dom.buildEmployeeTable(m,t,i,r),console.log(n)}})},queryCurrentReviewee:function(e){var t=a(o),n='<Query>\n<Where>\n<And>\n<And>\n<Eq>\n<FieldRef Name="ID"/>\n<Value Type="Text">'+e.id+'</Value>\n</Eq>\n<Eq>\n<FieldRef Name="lastName"/>\n<Value Type="Text">'+e.lastName+'</Value>\n</Eq>\n</And>\n<Eq>\n<FieldRef Name="firstName"/>\n<Value Type="Text">'+e.firstName+"</Value>\n</Eq>\n</And>\n</Where>\n</Query>";$().SPServices({operation:"GetListItems",viewName:"",webURL:s,listName:p,CAMLRowLimit:1,CAMLViewFields:t,CAMLQueryOptions:m,CAMLQuery:n,completefunc:function(e,t){console.log(t);var a=$(e.responseXML).SPFilterNode("z:row").SPXmlToJson({mapping:{ows_firstName:{mappedName:"firstName",objectType:"Text"},ows_lastName:{mappedName:"lastName",objectType:"Text"},ows_ID:{mappedName:"SP-ID",objectType:"Text"},ows_mgrSuprFlag:{mappedName:"mgrSuprFlag",objectType:"Text"},ows_positionTitle:{mappedName:"positionTitle",objectType:"Text"}},incluedAllAttrs:!0,removeOws:!0,sparse:!1});console.log($().SPServices.SPGetStaticFromDisplay({webURL:s,listName:p,columnDisplayNames:["firstName","lastName","ID","mgrSuprFlag","positionTitle"]})),elem=document.getElementById("reviewee-name"),elem.innerText="Reviewee: "+a[0].firstName+" "+a[0].lastName}})},parseCurrentReviewee:function(){var e=t.location.search,a={id:"",firstName:"",lastName:"",mgrSuprFlag:"",pmapDocID:""};e=(e=e.substr(1,e.length)).split("&");for(var n=0;n<e.length;n+=1)param=e[n].split("="),a.hasOwnProperty(param[0])&&(a[param[0]]=param[1]);return a},populateEmployeeInfo:function(e){var t=a(i),n='<Query>\n<Where>\n<And>\n<And>\n<Eq>\n<FieldRef Name="ID"/>\n<Value Type="Text">'+e.id+'</Value>\n</Eq>\n<Eq>\n<FieldRef Name="lastName"/>\n<Value Type="Text">'+e.lastName+'</Value>\n</Eq>\n</And>\n<Eq>\n<FieldRef Name="firstName"/>\n<Value Type="Text">'+e.firstName+"</Value>\n</Eq>\n</And>\n</Where>\n</Query>";$().SPServices({operation:"GetListItems",viewName:"",webURL:s,listName:p,CAMLRowLimit:1,CAMLViewFields:t,CAMLQueryOptions:m,CAMLQuery:n,completefunc:function(e,t){console.log(t);var a=$(e.responseXML).SPFilterNode("z:row").SPXmlToJson({mapping:{ows_firstName:{mappedName:"firstName",objectType:"Text"},ows_lastName:{mappedName:"lastName",objectType:"Text"},ows_ID:{mappedName:"SP-ID",objectType:"Text"},ows_organization:{mappedName:"organization",objectType:"Text"},ows_positionTitle:{mappedName:"positionTitle",objectType:"Text"},ows_positionSeries:{mappedName:"positionSeries",objectType:"Text"},ows_positionGrade:{mappedName:"positionGrade",objectType:"Text"},ows_mgrID:{mappedName:"mgrID",objectType:"Text"},ows_directorID:{mappedName:"directorID",objectType:"Text"}},incluedAllAttrs:!0,removeOws:!0,sparse:!1}),n=document.querySelectorAll("#projects-collections>.collection-item>.row>div:nth-child(2n)>p");n[0].innerText=a[0].firstName+" "+a[0].lastName,n[1].innerText=a[0].organization,n[2].innerText=a[0].positionSeries,n[3].innerText=a[0].positionGrade,""===a[0].mgrID?n[4].innerText=a[0].directorID:n[4].innerText=a[0].mgrID}})},saveEmployeeNarrative:function(){$("#textarea1").val()},getTablerecords:function(t){$("#my-pmap-events")&&$("#my-pmap-events tbody")&&$("#my-pmap-events tbody tr").length>0&&$("#my-pmap-events tbody").empty();var n=a(r),o=document.querySelector("#my-pmap-events"),i=o.querySelector("tbody"),p=[],l=[];$().SPServices({operation:"GetListItems",viewName:"",webURL:s,listName:t.listname,CAMLRowLimit:1e3,CAMLViewFields:n,CAMLQueryOptions:m,CAMLQuery:t.camlQuery,completefunc:function(a,n){var r=$(a.responseXML).SPFilterNode("z:row").SPXmlToJson({mapping:t.objMapping,incluedAllAttrs:!0,removeOws:!0,sparse:!1});console.log("RES: "),console.log(r);var m,s,d,u={iconText:"add",tooltip:"Edit this Reminder",linksRequired:!1,buttonDataId:"event_id"},c={iconText:"delete",tooltip:"Delete this Reminder",linksRequired:!1,buttonDataId:"event_id"},y={event_id:""},T=r.length;for(p=e.dom.createButtons(r,p,null,u,y),l=e.dom.createButtons(r,l,null,c,y),e.dom.buildEmployeeTable(r,o,i,p),d=0;d<T;d+=1)parseInt(l[d].dataset.index)===d&&(m=$("#my-pmap-events tr>td:last-child"),s=$("<td></td>").html(l[d]),m.eq(d).data("index")===s.data("index")&&m.eq(d).after(s));APP.dom.badgeExpiringDeadlines()}})},getEventsCamlQ:function(){return d},getEventsObjMap:function(){return u},getSPSListItems:function(t,n){var o=e.util.extendDeep(t);$().SPServices({operation:"GetListItems",viewName:"",webURL:t.webURL,listName:t.listName,CAMLRowLimit:t.rowLimit,CAMLViewFields:a(t.CAMLViewFields),CAMLQueryOptions:t.CAMLQueryOptions,CAMLQuery:t.CAMLQuery,completefunc:function(e,t){var a=$(e.responseXML).SPFilterNode("z:row").SPXmlToJson({mapping:o.mapping,includeAlAttrs:!0,removeOws:!0,sparse:!1});"success"===t?o.completefunc(a):(console.log(t),console.log(e.responseText))}})},getSingleEventQConfigObject:function(){$('input[name="event-type"]:checked').val();return c},getSingleEventUpdateQObj:function(){return y},getUpdateListFieldValsArr:function(){return T},updateSPSRecord:function(t){var a=e.util.extendDeep(t);console.log("$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$QueryObj Deep copy:"),console.dir(a),$().SPServices({operation:a.operation,webURL:a.webURL,listName:a.listName,batchCmd:a.batchCmd,updates:a.updates,ID:a.ID,completefunc:function(e,t){"success"===t?a.completefunc():console.log(t)}})},makeCAMLString:function(e,t,a,n){for(var o='<Batch OnError="Continue"><Method ID="'+Date.now()+'" Cmd="'+a+'">',i=0;i<t.length;i++)"pmapCoordinatorID"===t[i]?o+='<Field Name="'+t[i]+'">PMAP-COORD-12345</Field>':(o+='<Field Name="'+t[i],o+='">',o+=e[Object.getOwnPropertyNames(e)[i]],o+="</Field>");return o+='<Field Name="ID">'+n+"</Field>",o+="</Method></Batch>",console.log(o),o}}}(APP,this);
APP.Staff=function(){function t(e){if(this["SP-ID"]=e.SP_id,this.firstName=e.firstName,this.lastName=e.lastName,!this instanceof t)return new t(e)}var e=e||{};return{Staff:t,getStaffObjCache:function(){return e},setStaffObjCache:function(t){e.employee=t}}}();
APP.util=function(e){function t(e,a){var n,i=Object.prototype.toString;a=a||{};for(n in e)e.hasOwnProperty(n)&&("object"==typeof e[n]?(a[n]="[object Array]"===i.call(e[n])?[]:{},t(e[n],a[n])):a[n]=e[n]);return a}function a(t,a,n){n["SP-ID"]=t.target.dataset.recordId,e.Staff.setStaffObjCache(n),console.log("FROM INSIDE initPMAPReview: "),console.dir(e.Staff.getStaffObjCache()),null!==e.Staff.getStaffObjCache().employee&&"undefined"!==e.Staff.getStaffObjCache().employee&&a()}function n(){return window.location.href}return{extendDeep:t,initPMAPReview:a,handleEditClick:function(t){return function(n){var i=new e.Staff.Staff({"SP-ID":n.target.dataset.recordID});a(n,t,i)}},getCurrentURL:n,appendToURL:function(e,t){return e+"&"+t},nextURL:function(e,t){e?(t+="?id="+e.id,t+="&firstName="+e.firstName,t+="&lastName="+e.lastName,t+="&mgrSuprFlag="+e.mgrSuprFlag,t+="&pmapDocID="+e.pmapDocID,window.location.assign(t)):window.location.assign("./index3.html")},attachNextURLs:function(e){var t=$("a").has('div[id="colap"]').add("#continue").add("#save");if(e){var a=$.param(e);t.each(function(e,t){var n=t.getAttribute("href");t.setAttribute("href",n+"?"+a)})}},redirectOnNullReviewee:function(e){n();console.log("From redirectONNullReviewee: "),console.log(e),""===e.firstName&&""===e.lastName&&""===e.id&&window.location.assign("./index.html")}}}(APP);